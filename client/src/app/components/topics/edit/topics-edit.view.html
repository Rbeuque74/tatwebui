<div class="wrapper" data-ng-controller="TopicsEditCtrl">

  <div class="row">
      <div class="col-lg-6">
          <div class="group-profile">
              <div>
                  <label>{{ 'shared_common_name' | translate }}</label> : <span>{{topic.topic}}</span>
              </div>
              <div>
                  <label>{{ 'shared_common_description' | translate }}</label> : <span>{{topic.description}}</span>
              </div>
          </div>
      </div>
  </div>

  <div class="row" data-ng-if="topic._id">
    <h4>{{ 'shared_common_parameters' | translate }}</h4>
    <div class="col-lg-6">
      <form role="form">
        <div class="form-group">
          <label for="maxlength">{{ 'shared_common_topic' | translate}}</label>
          <input type="number" class="form-control" id="maxlength" data-ng-model="topic.maxlength" min="10" data-ng-required="true">
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.canForceDate">
             {{ 'components_topics_can_force_date' | translate}}
           </label>
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.canUpdateMsg">
             {{ 'components_topics_can_update_msg' | translate}}
           </label>
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.canDeleteMsg">
             {{ 'components_topics_can_delete_msg' | translate}}
           </label>
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.canUpdateAllMsg">
             {{ 'components_topics_can_update_all_msg' | translate}}
           </label>
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.canDeleteAllMsg">
             {{ 'components_topics_can_delete_all_msg' | translate}}
           </label>
        </div>
        <div class="checkbox">
           <label>
             <input type="checkbox" data-ng-model="topic.isROPublic">
             {{ 'components_topics_is_ro_public' | translate}}
           </label>
        </div>
        <button type="submit" class="btn btn-default" data-ng-click="updateParam(false)">
          {{ 'shared_common_validate' | translate}}
        </button>
        <button type="submit" class="btn btn-default" data-ng-click="updateParam(true)">
          {{ 'shared_common_validate' | translate}} {{ 'shared_common_recursively' | translate}}
        </button>
      </form>
    </div>
  </div>

  <div class="row" data-ng-if="topic._id">
    <h4>{{ 'shared_common_users' | translate }}</h4>
    <div class="col-lg-6">
      <ui-select data-ng-model="user.selected" theme="bootstrap">
          <ui-select-match placeholder="Select or search a user in the list...">{{$select.selected.username}}</ui-select-match>
          <ui-select-choices repeat="item in users | filter: $select.search">
            <div>{{item.username}}</div>
          </ui-select-choices>
        </ui-select>
        <div class="btn-group-vertical" role="group" aria-label="...">
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"  data-ng-disabled="!user.selected">
              {{ 'components_topics_add_ro_user' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addRoUser(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addRoUser(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ng-disabled="!user.selected">
              {{ 'components_topics_add_rw_user' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addRwUser(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addRwUser(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ng-disabled="!user.selected">
              <i class="fa fa-user-md"></i> {{ 'components_topics_add_user_admin' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addAdminUser(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addAdminUser(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-4">
      <b>{{ 'shared_common_read_only' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.roUsers">
          {{v}}

          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveRoUser=true" data-ng-hide="askRemoveRoUser">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveRoUser=false" data-ng-show="askRemoveRoUser"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveRoUser">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeRoUser(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeRoUser(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-lg-4">
      <b>{{ 'shared_common_read_write' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.rwUsers">
          {{v}}

          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveRwUser=true" data-ng-hide="askRemoveRwUser">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveRwUser=false" data-ng-show="askRemoveRwUser"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveRwUser">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeRwUser(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeRwUser(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-lg-4">
      <b>{{ 'shared_common_administrators' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.adminUsers">
          {{v}}

          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveAdminUser=true" data-ng-hide="askRemoveAdminUser">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveAdminUser=false" data-ng-show="askRemoveAdminUser"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveAdminUser">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeAdminUser(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeAdminUser(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <div class="row" data-ng-if="topic._id">
    <h4>{{ 'shared_common_groups' | translate }}</h4>
    <div class="col-lg-6">
      <ui-select data-ng-model="group.selected" theme="bootstrap">
          <ui-select-match placeholder="Select or search a group in the list...">{{$select.selected.name}}</ui-select-match>
          <ui-select-choices repeat="item in groups | filter: $select.search">
            <div>{{item.name}}</div>
          </ui-select-choices>
        </ui-select>

        <div class="btn-group-vertical" role="group" aria-label="...">
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ng-disabled="!group.selected">
              {{ 'components_topics_add_ro_group' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addRoGroup(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addRoGroup(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ng-disabled="!group.selected">
              {{ 'components_topics_add_rw_group' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addRwGroup(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addRwGroup(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ng-disabled="!group.selected">
              <i class="fa fa-user-md"></i> {{ 'components_topics_add_group_admin' | translate}}
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="addAdminGroup(false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="addAdminGroup(true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-4">
      <b>{{ 'shared_common_read_only' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.roGroups">
          {{v}}
          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveRoGroup=true" data-ng-hide="askRemoveRoGroup">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveRoGroup=false" data-ng-show="askRemoveRoGroup"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveRoGroup">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeRoGroup(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeRoGroup(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-lg-4">
      <b>{{ 'shared_common_read_write' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.rwGroups">
          {{v}}

          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveRwGroup=true" data-ng-hide="askRemoveRwGroup">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveRwGroup=false" data-ng-show="askRemoveRwGroup"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveRwGroup">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeRwGroup(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeRwGroup(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-lg-4">
      <b>{{ 'shared_common_administrators' | translate }} : </b>
      <ul>
        <li data-ng-repeat="(k, v) in topic.adminGroups">
          {{v}}

          <button class="btn btn-xs btn-default btn-warning" data-ng-click="askRemoveAdminGroup=true" data-ng-hide="askRemoveAdminGroup">
             <i class="fa fa-trash-o"></i>
          </button>
          <button data-ng-click="askRemoveAdminGroup=false" data-ng-show="askRemoveAdminGroup"
                    class="btn btn-xs btn-default btn-info">
                    {{ 'components_topics_dont_want_remove_group' | translate}}
              <i class="fa fa-reply"></i>
          </button>
          <div class="btn-group" role="group" data-ng-show="askRemoveAdminGroup">
            <button type="button" class="btn btn-xs btn-default btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {{ 'shared_common_yes_i_confirm' | translate}} <i class="fa fa-exclamation-triangle"></i>
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a role="button" data-ng-click="removeAdminGroup(v, false)">{{ 'components_topics_only_topic' | translate}}</a></li>
              <li><a role="button" data-ng-click="removeAdminGroup(v, true)">{{ 'shared_common_recursively' | translate}}</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
